import{h as y,j as n,k as r,l as c,m as e,p as w,v as C,q as x,D as b,F as p,x as u,y as s,r as $,o as M,u as d,I as B,C as S}from"./index-Cxdx-ytl.js";import{_ as I}from"./_plugin-vue_export-helper-DlAUqK2U.js";const z=y({props:{isShown:Boolean,closeModal:Function,id:String,botId:Number,bot_token:String},data(){return{ch_id:"",text:""}},methods:{async addChannel(){console.log(this.store),u.addChannels(this.id,this.ch_id,this.botId,{bot_token:this.bot_token,chat_id:this.ch_id}).then(()=>{u.getChannels(this.id).then(t=>{s.data.channels=t}),this.closeModal(),this.ch_id=""}).catch(t=>{this.text="",this.text=t})}}}),D={key:1,class:"fixed top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 z-50"},V={class:"relative p-4 w-full max-w-md max-h-full top-0 right-0 left-0 z-50"},j={class:"relative bg-white rounded-lg shadow dark:bg-gray-700 min-w-80"},A={class:"flex items-center justify-between p-4 md:p-5 border-b rounded-t dark:border-gray-600"},N=e("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white"},"Добавить канал",-1),F=e("svg",{class:"w-3 h-3","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 14 14"},[e("path",{stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"})],-1),q=e("span",{class:"sr-only"},"Close modal",-1),T=[F,q],E=["onsubmit"],H={class:"grid gap-4 mb-4 grid-cols-2"},L={class:"col-span-2"},O=e("label",{for:"name",class:"block mb-2 text-sm font-medium text-gray-900 dark:text-white"},"ID канала в телеграм",-1),P=e("svg",{class:"me-1 -ms-1 w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg"},[e("path",{"fill-rule":"evenodd",d:"M10 5a1 1 0 011 1v3h3a1 1 0 110 2h-3v3a1 1 0 11-2 0v-3H6a1 1 0 110-2h3V6a1 1 0 011-1z","clip-rule":"evenodd"})],-1);function U(t,a,f,_,l,k){return n(),r(p,null,[t.isShown?(n(),r("div",{key:0,onClick:a[0]||(a[0]=(...o)=>t.closeModal&&t.closeModal(...o)),class:"top-0 left-0 h-screen w-screen bg-gray-900 fixed opacity-20 z-40"})):c("",!0),t.isShown?(n(),r("div",D,[e("div",V,[e("div",j,[e("div",A,[N,e("button",{onClick:a[1]||(a[1]=(...o)=>t.closeModal&&t.closeModal(...o)),type:"button",class:"text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm w-8 h-8 ms-auto inline-flex justify-center items-center dark:hover:bg-gray-600 dark:hover:text-white","data-modal-toggle":"crud-modal"},T)]),e("form",{onsubmit:o=>o.preventDefault(),class:"p-4 md:p-5"},[e("div",H,[e("div",L,[O,w(e("input",{type:"text",name:"name",id:"name",class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500",placeholder:"@example",required:"","onUpdate:modelValue":a[2]||(a[2]=o=>t.ch_id=o)},null,512),[[C,t.ch_id]])]),x(" "+b(t.text),1)]),e("button",{onClick:a[3]||(a[3]=(...o)=>t.addChannel&&t.addChannel(...o)),type:"submit",class:"text-white inline-flex items-center bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-800"},[P,x(" Добавить канал ")])],8,E)])])])):c("",!0)],64)}const G=I(z,[["render",U]]),J={class:"flex px-4 mt-20"},K={class:""},Q={key:1},R=e("p",{class:"flex px-6 py-2 rounded-md bg-neutral-100 w-auto"},"Сначала добавьте бота",-1),W=[R],X=e("div",{class:"flex justify-evenly flex-wrap"},null,-1),Y={class:"flex justify-evenly flex-wrap"},Z={class:"flex items-center"},ee={class:"mb-2 text-2xl font-bold truncate tracking-tight text-gray-900 dark:text-white"},te=["onClick"],oe={class:"truncate max-w-60 w-auto dark:text-neutral-200"},ne={__name:"ChannelsPage",props:{id:{type:String}},setup(t){const a=$();function f(){a.value?a.value=!1:a.value=!0}M(()=>{u.getOrganizationBots(l.id).then(o=>{var h,g;if(s.data.bots=o,((h=s.data.bots)==null?void 0:h.length)===0){s.data.canAddBots=!0;return}s.auth.bot_id=(g=s.data.bots[0])==null?void 0:g.bot_id}),u.getChannels(l.id).then(o=>{s.data.channels=o}),console.log(s.data.channels)});function _(){a.value=!1}const l=t;function k(o){console.log(o),u.deleteChannels(l.id,o).then(()=>{u.getChannels(l.id).then(h=>{s.data.channels=h})})}return(o,h)=>{var g;return n(),r(p,null,[e("div",J,[e("div",K,[d(s).data.canAddBots===!1&&d(s).auth.permissions.some(i=>i.name==="admin"||i.name==="owner")?(n(),r("button",{key:0,onClick:f,class:"block text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-800"}," Добавить канал ")):c("",!0),d(s).data.canAddBots===!0?(n(),r("div",Q,W)):c("",!0),X,e("div",Y,[(n(!0),r(p,null,B(d(s).data.channels,(i,v)=>(n(),r("div",{key:v,class:"mt-4 mx-2 p-6 bg-white border border-gray-200 rounded-lg shadow dark:bg-gray-800 dark:border-gray-700"},[e("div",Z,[e("h5",ee,b(i.name),1),d(s).auth.permissions.some(m=>m.name==="admin"||m.name==="owner")?(n(),r("button",{key:0,onClick:m=>k(i.id),class:"ml-4 mb-2 p-1 text-red-600 bg-red-100 hover:bg-red-200 rounded-md font-medium flex"}," Удалить ",8,te)):c("",!0)]),e("p",oe,b(i.telegram_id),1)]))),128))])])]),a.value?(n(),S(G,{key:0,isShown:a.value,closeModal:_,id:l.id,botId:d(s).auth.bot_id,bot_token:(g=d(s).data.bots[0])==null?void 0:g.bot_token},null,8,["isShown","id","botId","bot_token"])):c("",!0)],64)}}};export{ne as default};
