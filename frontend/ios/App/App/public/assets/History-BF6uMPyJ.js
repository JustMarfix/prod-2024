import{e as k,o as x,j as d,k as n,m as a,D as i,l as u,u as f,J as y,x as w,F as v,I as $,C as S}from"./index-Cxdx-ytl.js";import{c as h}from"./statusesConverter-D18FyVg_.js";const T={class:"p-6 flex flex-col h-full w-full bg-white border border-gray-200 rounded-lg shadow dark:bg-gray-800 dark:border-gray-700"},D={class:"mb-5 text-lg font-bold text-gray-500 dark:text-gray-400"},P={key:0,class:"mb-2 text-lg p-3 border-gray-300 border-[1px] rounded-md font-normal text-gray-500 dark:text-gray-400",role:"alert"},B=["id"],j={key:2,class:"mb-2 p-4 text-sm text-red-800 rounded-lg bg-red-50 dark:bg-gray-800 dark:text-red-400",role:"alert"},H=a("span",{class:"font-medium"},"Пост в приватном канале",-1),M=[H],A={class:"flex gap-1 mt-auto flex-wrap flex-col"},E={class:"flex"},F={class:"text-wrap text-left dark:text-neutral-200"},L={class:"flex gap-1 mt-1 flex-wrap flex-col"},O={class:"p-2 bg-blue-100 dark:bg-blue-500 dark:text-white rounded-md"},z={class:"p-2 bg-blue-100 dark:bg-blue-500 dark:text-white rounded-md"},C={__name:"HistoryPost",props:{post:{type:Object,default:{}}},setup(c){const t=c,l=k(()=>{var e,s;return!!((s=(e=t.post)==null?void 0:e.sent_infos)!=null&&s.find(({chat_username:r})=>!!r))}),p=()=>new Promise(e=>{var g,_;const{chat_username:s,telegram_message_id:r}=(_=(g=t.post)==null?void 0:g.sent_infos)==null?void 0:_.find(({chat_username:b})=>!!b),o=document.createElement("script");o.src="https://telegram.org/js/telegram-widget.js?22",o.setAttribute("data-telegram-post",`${s}/${r}`),o.setAttribute("data-width","100%"),localStorage.getItem("vueuse-color-scheme")!=="light"&&o.setAttribute("data-dark",1),o.onload=e,document.getElementById(`${t.post.id}-post`).append(o)});x(()=>{var e,s;(s=(e=t.post)==null?void 0:e.sent_infos)!=null&&s.find(({chat_username:r})=>!!r)&&p()});const m=e=>{if(!e)return"";const s=new Date(e),r=new Date().getTimezoneOffset(),o=new Date(s.getTime()-r*6e4);return"Опубликован "+`${String(o.getDate()).padStart(2,"0")}.${String(o.getMonth()+1).padStart(2,"0")}.${o.getFullYear()} ${String(o.getHours()).padStart(2,"0")}:${String(o.getMinutes()).padStart(2,"0")}`};return(e,s)=>(d(),n("div",T,[a("h3",D,"#"+i(t.post.id),1),l.value?u("",!0):(d(),n("div",P,i(t.post.content),1)),l.value?(d(),n("div",{key:1,class:"pb-5 md:flex",id:`${t.post.id}-post`},null,8,B)):u("",!0),l.value?u("",!0):(d(),n("div",j,M)),a("div",A,[a("div",E,[a("p",F,i(m(c.post.planned_time)),1)]),a("div",L,[a("div",O,i(f(h)(t.post.is_approved)),1),a("div",z,i(f(h)(t.post.sent_status)),1)])])]))}},I={class:"flex mt-17 w-full"},N={class:"w-full px-4"},V=a("h1",{class:"text-3xl mb-6 font-bold leading-tight tracking-tight text-gray-900 dark:text-white"}," История постов ",-1),J={class:"grid grid-cols-1 gap-2 w-full mb-4 max-w-2xl"},G={__name:"History",props:{id:{type:String}},setup(c){const t=y({isShowModal:!1,targetPost:{},creation:!1,posts:[]});x(()=>{w.getHistory(l.id).then(p=>{t.posts=p,t.targetPost={}})});const l=c;return(p,m)=>(d(),n("div",I,[a("div",N,[V,a("div",J,[(d(!0),n(v,null,$(t.posts,(e,s)=>(d(),S(C,{key:s,post:e},null,8,["post"]))),128))])])]))}};export{G as default};
